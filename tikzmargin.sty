\newcommand{\tikzmark}[2][]{%
\tikz[remember picture, baseline]{\node[
	anchor=base, inner sep=0pt, outer sep=0pt] (tikzmark#1) {#2};}}

\tikzstyle{north}=[90]
\tikzstyle{south}=[270]
\tikzstyle{west}=[180]
\tikzstyle{east}=[0]
\newcommand{\tikzmargin}[3][]{
	\marginpar{\tikz[baseline, remember picture]{
		\node[anchor=base, text width=\marginparwidth, align=left,
			inner sep=0pt, outer sep=0pt,
			font=\sffamily\scriptsize] 
			(tikzmargin#1) 
			{#3};}}
	\begin{tikzpicture}[overlay, remember picture]
		\draw[gray!30] (tikzmargin#1.north west) +(3pt,3pt)
			-| ($(tikzmargin#1.south west)-(3pt,0)$) |- +(3pt,-3pt); 
		\path[->, line width=1.5pt, gray, opacity=0.3, 
			shorten <=5pt, shorten >=5pt]
			(tikzmargin#1) edge[in=#2, out=180] (tikzmark#1);
	\end{tikzpicture}
}